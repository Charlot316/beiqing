(this["webpackJsonpworld-skill"]=this["webpackJsonpworld-skill"]||[]).push([[7],{439:function(e,t,a){"use strict";a.r(t);a(299);var n=a(301),r=a.n(n),c=(a(284),a(288)),o=a.n(c),i=(a(293),a(294)),l=a.n(i),s=(a(370),a(374)),u=a.n(s),d=(a(333),a(336)),p=a.n(d),m=(a(357),a(330)),f=a.n(m),v=(a(297),a(298)),b=a.n(v),h=(a(303),a(305)),_=a.n(h),E=(a(371),a(372)),g=a.n(E),y=(a(149),a(60)),x=a.n(y),k=a(44),I=a(45),j=a(47),w=a(46),C=(a(334),a(335)),O=a.n(C),S=a(0),T=a.n(S),B=a(311),P=a(289),N=a(730),R=a.n(N),U=a(310),V=a.n(U),z=a(10),G=a.n(z),q=a(19),A=(a(147),a(34)),L=(a(33),a(277)),H=a(281);function J(){return(J=Object(q.a)(G.a.mark((function e(t){var a,n,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object(L.a)(t),t.role!=H.c){e.next=8;break}return e.next=4,A.a.get("/api/teacher/skillScore".concat(a));case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.next=10,A.a.get("/api/student/skillScore".concat(a));case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(q.a)(G.a.mark((function e(t){var a,n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(L.a)(t),e.next=3,A.a.get("/api/student/details".concat(a));case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){return(X=Object(q.a)(G.a.mark((function e(t){var a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.a.post("/api/teacher/textScore/detail",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return(Y=Object(q.a)(G.a.mark((function e(t){var a,n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(L.a)(t),e.next=3,A.a.get("/api/teacher/status".concat(a));case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return K.apply(this,arguments)}function K(){return(K=Object(q.a)(G.a.mark((function e(t){var a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.a.post("/api/teacher/studentScore",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=O.a.TabPane,W={},Z=[],F=[],$=[],ee=0,te=0,ae=function(e){Object(j.a)(a,e);var t=Object(w.a)(a);function a(e){var n;Object(k.a)(this,a),(n=t.call(this)).slot={left:T.a.createElement("div",{className:R.a.returnButton},T.a.createElement("a",{onClick:function(){n.props.history.goBack()}},T.a.createElement(B.a,null,"\u8fd4\u56de")))};var r=e.location.search,c=V.a.parse(r.slice(1)),o=c.topicId,i=c.type,l=c.studentId,s=Object(L.b)("userType");W={topicId:o,type:i,studentId:l,role:s};var u="",d=!1;return s==H.c?u="/app/teacher/grade":(d=!0,u="/app/student/grade"),n.state={path:u,modalRejectVisible:!1,disabled:d},n}return Object(I.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.scrollTo(0,0),te=0,$=[],function(e){return J.apply(this,arguments)}(W).then((function(t){Z=t.data,ee=0,Z.map((function(e,t){ee+=e.score,F[t]={},$[t]={score:-1,studentId:W.studentId,topicId:W.topicId,scoreId:e.id,optionId:0}})),Object(L.b)("userType")==H.b?function(e){return M.apply(this,arguments)}(W).then((function(t){(F=t.data).map((function(e,t){te+=e.score,$[t].score=e.score})),e.forceUpdate()})):function(e){return Y.apply(this,arguments)}(W).then((function(t){0==t.data&&(e.props.history.replace("score?type=3&studentId=".concat(W.studentId,"&topicId=").concat(W.topicId)),x.a.warning("\u5b66\u751f\u672a\u63d0\u4ea4\u6587\u672c\uff0c\u4e0d\u80fd\u8bc4\u5206"))})),e.forceUpdate()}))}},{key:"findOptionId",value:function(e,t){var a=0;return e.map((function(e){e.score==t&&(a=e.optionId)})),a}},{key:"recountTotal",value:function(){for(var e in te=0,$)-1!=$[e].score&&(te+=$[e].score);this.forceUpdate()}},{key:"handleSubmit",value:function(){for(var e in $)if(-1==$[e].score)return x.a.error("\u63d0\u4ea4\u5931\u8d25\uff0c\u8bf7\u9009\u5b8c\u6240\u6709\u9009\u9879");(function(e){return X.apply(this,arguments)})($).then((function(e){0!==e.code?x.a.error("\u63d0\u4ea4\u5931\u8d25 ".concat(e.data)):(W.status=2,W.textComment=null,D(W).then((function(t){0!==t.code?x.a.error("\u63d0\u4ea4\u5931\u8d25 ".concat(t.data)):x.a.success(e.data)})))}))}},{key:"handleReject",value:function(){var e=this;W.status=3,D(W).then((function(t){0!==t.code?x.a.error("\u9a73\u56de\u5931\u8d25 ".concat(t.data)):(x.a.success("\u9a73\u56de\u6210\u529f"),e.setState({modalRejectVisible:!1}))}))}},{key:"render",value:function(){var e=this;return T.a.createElement(P.a,{path:this.state.path,name:"activity1"},T.a.createElement(g.a,null),T.a.createElement(b.a,{offsetTop:60},T.a.createElement("div",null,T.a.createElement("div",{className:R.a.topBar},T.a.createElement(O.a,{defaultActiveKey:"2",centered:!0,tabBarExtraContent:this.slot,onChange:function(t){1==t?(e.props.history.replace("score?type=3&studentId=".concat(W.studentId,"&topicId=").concat(W.topicId)),e.forceUpdate()):3==t&&(e.props.history.replace("edit?topicId=".concat(W.topicId)),e.forceUpdate())}},T.a.createElement(Q,{tab:"\u6587\u672c\u5185\u5bb9",key:"1"}),Object(L.b)("userType")==H.b?T.a.createElement(Q,{tab:"\u7f16\u8f91\u6587\u672c",key:"3"}):"",T.a.createElement(Q,{tab:"\u8bc4\u5206\u6807\u51c6",key:"2"}))),T.a.createElement("div",{className:R.a.currentScore},T.a.createElement(_.a,null,"\u5f53\u524d\u5f97\u5206"),T.a.createElement(_.a,null," ",te,"/",ee," ")))),T.a.createElement(_.a,null,T.a.createElement(p.a,{offset:2,span:20},T.a.createElement(l.a,{name:"basic",initialValues:F},Z.map((function(t,a){var n,r,c,o,i,s,d,m,v;return T.a.createElement(l.a.Item,{name:t.id,key:t.id,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9009\u9879"}]},T.a.createElement("div",null,T.a.createElement(u.a,{hoverable:!0,title:T.a.createElement("span",{className:[R.a.cardTitle]},"".concat(a+1,".").concat(t.title))},T.a.createElement(_.a,null,T.a.createElement(p.a,{span:20},0==t.options.length?T.a.createElement(f.a.Group,{key:t.id,value:null===(n=F[a])||void 0===n?void 0:n.score,onChange:function(t){F[a].score=t.target.value,$[a].score=t.target.value,e.recountTotal(),e.forceUpdate()}},T.a.createElement(f.a,{value:1,key:t.id+"\u662f",disabled:e.state.disabled},T.a.createElement("span",{className:R.a.dialogContent},"\u662f(1\u5206)")),";",T.a.createElement(f.a,{value:0,key:t.id+"\u5426",disabled:e.state.disabled},T.a.createElement("span",{className:R.a.dialogContent},"\u5426(0\u5206)")),";"):T.a.createElement(f.a.Group,{key:t.id,value:null===(r=F[a])||void 0===r?void 0:r.score,onChange:function(n){F[a].score=n.target.value,$[a].score=n.target.value,$[a].optionId=e.findOptionId(t.options,n.target.value),e.recountTotal(),e.forceUpdate()}},t.options.map((function(t){return T.a.createElement("div",{key:t.optionId},T.a.createElement(f.a,{value:t.score,disabled:e.state.disabled},T.a.createElement("span",{className:R.a.dialogContent},"".concat(t.title,"(").concat(t.score,"\u5206)"))),T.a.createElement("br",null))})))),T.a.createElement(p.a,{span:4},T.a.createElement("div",{className:0==(null===(c=$[a])||void 0===c?void 0:c.score)?R.a.partialPoint0:[(null===(o=$[a])||void 0===o?void 0:o.score)==(null===(i=Z[a])||void 0===i?void 0:i.score)?R.a.partialPoint2:R.a.partialPoint1]},-1==$[a].score?null:$[a].score)))),T.a.createElement("div",{className:-1==(null===(s=$[a])||void 0===s?void 0:s.score)?R.a.rectangle:[0==(null===(d=$[a])||void 0===d?void 0:d.score)?R.a.rectangle0:[(null===(m=$[a])||void 0===m?void 0:m.score)==(null===(v=Z[a])||void 0===v?void 0:v.score)?R.a.rectangle2:R.a.rectangle1]]})))})),T.a.createElement(l.a.Item,null,T.a.createElement(B.a,{size:"large",type:"primary",htmlType:"submit",disabled:this.state.disabled,onClick:function(){return e.handleSubmit()}},"\u63d0\u4ea4"),T.a.createElement(B.a,{className:R.a.rejectButton,size:"large",danger:!0,disabled:this.state.disabled,onClick:function(){e.setState({modalRejectVisible:!0}),W.textComment=""}},"\u9a73\u56de"))))),T.a.createElement(r.a,{title:"\u9a73\u56de\u4fe1\u606f",visible:this.state.modalRejectVisible,onCancel:function(){x.a.warning("\u53d6\u6d88\u9a73\u56de"),e.setState({modalRejectVisible:!1})},onOk:function(){e.handleReject()},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},T.a.createElement(l.a,{name:"\u9a73\u56de\u539f\u56e0",key:"\u9a73\u56de\u539f\u56e0",labelCol:{span:8},wrapperCol:{span:16}},T.a.createElement(l.a.Item,{label:"\u9a73\u56de\u539f\u56e0",name:"message",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u9a73\u56de\u539f\u56e0"}]},T.a.createElement(o.a,{onPressEnter:function(){return e.handleReject()},onChange:function(e){return W.textComment=e.target.value}})))))}}]),a}(T.a.Component);t.default=ae},730:function(e,t,a){e.exports={returnButton:"index_returnButton__2nbxV",textButton:"index_textButton__2iS7u",dialogContent:"index_dialogContent__mLYr5",partialPoint0:"index_partialPoint0__1BPlS",partialPoint1:"index_partialPoint1__2ltf5",partialPoint2:"index_partialPoint2__1wZtX",cardTitle:"index_cardTitle__2_rn1",dialogScore:"index_dialogScore__TYXqG",cardScore:"index_cardScore__2sO6L",rectangle0:"index_rectangle0__xu5cd",rectangle1:"index_rectangle1__2jWui",rectangle2:"index_rectangle2__1wGaM",rectangle:"index_rectangle__3zRtd",topBar:"index_topBar__AQtHL",rejectButton:"index_rejectButton__2OH0A",currentScore:"index_currentScore__ubcz2"}}}]);